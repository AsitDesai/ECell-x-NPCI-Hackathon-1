# Documentation for the Code

This Python script demonstrates the creation and management of a simple in-memory SQLite database for a customer loyalty and rewards system. The script includes the creation of tables, insertion of sample data, and the generation of a real-time dashboard using `matplotlib` to visualize transaction volumes, reward points, and profitability trends.

---

## **1. Overview**

The script performs the following tasks:
1. **Database Setup**: Creates an in-memory SQLite database with multiple tables to manage customers, vendors, transactions, reward policies, analytics, reward allocations, and products.
2. **Sample Data Insertion**: Populates the tables with sample data for demonstration purposes.
3. **Data Visualization**: Generates a real-time dashboard using `matplotlib` to visualize:
   - Transaction volumes per vendor.
   - Reward points issued vs. redeemed per vendor.
   - Profitability trends (revenue minus rewards) per vendor.

---

## **2. Database Schema**

The database consists of the following tables:

### **2.1 Customers**
- Stores customer information.
- Columns:
  - `customer_id` (Primary Key): Unique identifier for the customer.
  - `name`: Customer's name.
  - `email`: Customer's email (unique).
  - `phone`: Customer's phone number (unique).
  - `wallet_balance`: Customer's wallet balance.
  - `created_at`: Timestamp when the customer was created.
  - `updated_at`: Timestamp when the customer was last updated.

### **2.2 Vendors**
- Stores vendor information.
- Columns:
  - `vendor_id` (Primary Key): Unique identifier for the vendor.
  - `name`: Vendor's name.
  - `category`: Vendor's category (`small`, `medium`, or `large`).
  - `location`: Vendor's location.
  - `created_at`: Timestamp when the vendor was created.
  - `updated_at`: Timestamp when the vendor was last updated.

### **2.3 Transactions**
- Stores transaction details.
- Columns:
  - `transaction_id` (Primary Key): Unique identifier for the transaction.
  - `customer_id`: Foreign key referencing the customer.
  - `vendor_id`: Foreign key referencing the vendor.
  - `amount`: Transaction amount.
  - `reward_points`: Reward points earned in the transaction.
  - `timestamp`: Timestamp of the transaction.

### **2.4 RewardPolicies**
- Stores reward policies for different vendor categories.
- Columns:
  - `policy_id` (Primary Key): Unique identifier for the policy.
  - `category`: Vendor category (`small`, `medium`, or `large`).
  - `threshold`: Minimum transaction amount to earn rewards.
  - `reward_percentage`: Percentage of the transaction amount awarded as reward points.
  - `redeemable_percentage`: Percentage of reward points that can be redeemed.

### **2.5 Analytics**
- Stores analytics data for vendors.
- Columns:
  - `analytics_id` (Primary Key): Unique identifier for the analytics record.
  - `vendor_id`: Foreign key referencing the vendor.
  - `popular_product`: Most popular product for the vendor.
  - `total_transactions`: Total number of transactions for the vendor.
  - `total_revenue`: Total revenue generated by the vendor.
  - `updated_at`: Timestamp when the analytics were last updated.

### **2.6 RewardAllocations**
- Stores reward points allocated to customers.
- Columns:
  - `allocation_id` (Primary Key): Unique identifier for the reward allocation.
  - `customer_id`: Foreign key referencing the customer.
  - `transaction_id`: Foreign key referencing the transaction.
  - `reward_points`: Reward points allocated.
  - `redeemed_points`: Reward points redeemed.
  - `timestamp`: Timestamp of the reward allocation.

### **2.7 Products**
- Stores product details.
- Columns:
  - `product_id` (Primary Key): Unique identifier for the product.
  - `product_name`: Name of the product.
  - `customer_id`: Foreign key referencing the customer who purchased the product.
  - `vendor_id`: Foreign key referencing the vendor selling the product.
  - `transaction_id`: Foreign key referencing the transaction.
  - `price`: Price of the product.
  - `timestamp`: Timestamp of the product purchase.
  - `location`: Location where the product was purchased.
  - `frequency_of_buying`: Frequency of buying the product.

---

## **3. Functions**

### **3.1 `display_table(cursor, table_name)`**
- Displays the contents of a specified table in a formatted manner using the `tabulate` library.
- Parameters:
  - `cursor`: SQLite database cursor.
  - `table_name`: Name of the table to display.

### **3.2 `get_transaction_volumes()`**
- Retrieves the number of transactions per vendor.
- Returns:
  - A list of tuples containing `vendor_id` and the count of transactions.

### **3.3 `get_reward_points_issued_and_redeemed()`**
- Retrieves the total reward points issued and redeemed per vendor.
- Returns:
  - A list of tuples containing `vendor_id`, total reward points issued, and total reward points redeemed.

### **3.4 `get_profitability()`**
- Retrieves the total revenue and total rewards per vendor.
- Returns:
  - A list of tuples containing `vendor_id`, total revenue, and total rewards.

### **3.5 `plot_transaction_volumes(vendor_data)`**
- Plots a bar chart of transaction volumes per vendor.
- Parameters:
  - `vendor_data`: Data returned by `get_transaction_volumes()`.

### **3.6 `plot_reward_points(vendor_data)`**
- Plots a grouped bar chart of reward points issued vs. redeemed per vendor.
- Parameters:
  - `vendor_data`: Data returned by `get_reward_points_issued_and_redeemed()`.

### **3.7 `plot_profitability(vendor_data)`**
- Plots a line chart of profitability trends (revenue minus rewards) per vendor.
- Parameters:
  - `vendor_data`: Data returned by `get_profitability()`.

### **3.8 `real_time_dashboard()`**
- Generates a real-time dashboard with three subplots:
  1. Transaction volumes per vendor.
  2. Reward points issued vs. redeemed per vendor.
  3. Profitability trends per vendor.

---

## **4. Sample Data**

The script inserts sample data into all tables for demonstration purposes. The data includes:
- 5 customers.
- 5 vendors.
- 5 transactions.
- 5 reward policies.
- 5 analytics records.
- 5 reward allocations.
- 5 products.

---

## **5. Visualization**

The `real_time_dashboard()` function generates a dashboard with three visualizations:
1. **Transaction Volumes**: Bar chart showing the number of transactions per vendor.
2. **Reward Points Issued vs. Redeemed**: Grouped bar chart comparing reward points issued and redeemed per vendor.
3. **Profitability Trends**: Line chart showing profitability (revenue minus rewards) per vendor.

---

## **6. Dependencies**

The script requires the following Python libraries:
- `sqlite3`: For database operations.
- `datetime`: For timestamp generation.
- `tabulate`: For displaying table data in a formatted manner.
- `matplotlib`: For generating visualizations.
- `numpy`: For numerical operations (used in plotting).

Install the required libraries using:
```bash
pip install tabulate matplotlib numpy
```

---

## **7. Usage**

1. Run the script to create the in-memory SQLite database and populate it with sample data.
2. The script will display the contents of all tables in the console.
3. A real-time dashboard will be generated using `matplotlib` to visualize transaction volumes, reward points, and profitability trends.

---

## **8. Notes**

- The database is in-memory and will be lost when the script ends.
- The sample data is static and can be modified to test different scenarios.
- The visualizations are basic and can be customized further based on requirements.

---

## **9. Example Output**

### **9.1 Table Display**

## Table: Customers
| customer_id | name   | email              | phone       | wallet_balance | created_at          | updated_at          |
|-------------|--------|--------------------|-------------|----------------|---------------------|---------------------|
| C001        | Alice  | alice@example.com  | 1234567890  | 50             | 2025-01-28 21:26:18 | 2025-01-28 21:26:18 |
| C002        | Bob    | bob@example.com    | 0987654321  | 20             | 2025-01-28 21:26:18 | 2025-01-28 21:26:18 |
| C003        | Charlie| charlie@example.com| 1122334455  | 100            | 2025-01-28 21:26:18 | 2025-01-28 21:26:18 |
| C004        | David  | david@example.com  | 2233445566  | 150            | 2025-01-28 21:26:18 | 2025-01-28 21:26:18 |
| C005        | Eve    | eve@example.com    | 3344556677  | 75             | 2025-01-28 21:26:18 | 2025-01-28 21:26:18 |

---

## Table: Vendors
| vendor_id | name     | category | location    | created_at          | updated_at          |
|-----------|----------|----------|-------------|---------------------|---------------------|
| V001      | Vendor A | small    | Location A  | 2025-01-28 21:26:18 | 2025-01-28 21:26:18 |
| V002      | Vendor B | medium   | Location B  | 2025-01-28 21:26:18 | 2025-01-28 21:26:18 |
| V003      | Vendor C | large    | Location C  | 2025-01-28 21:26:18 | 2025-01-28 21:26:18 |
| V004      | Vendor D | small    | Location D  | 2025-01-28 21:26:18 | 2025-01-28 21:26:18 |
| V005      | Vendor E | medium   | Location E  | 2025-01-28 21:26:18 | 2025-01-28 21:26:18 |

---

## Table: Transactions
| transaction_id | customer_id | vendor_id | amount | reward_points | timestamp           |
|----------------|-------------|-----------|--------|---------------|---------------------|
| T001           | C001        | V001      | 100    | 10            | 2025-01-28 21:26:18 |
| T002           | C002        | V002      | 200    | 20            | 2025-01-28 21:26:18 |
| T003           | C003        | V003      | 150    | 15            | 2025-01-28 21:26:18 |
| T004           | C004        | V004      | 250    | 25            | 2025-01-28 21:26:18 |
| T005           | C005        | V005      | 300    | 30            | 2025-01-28 21:26:18 |

---

## Table: RewardPolicies
| policy_id | category | threshold | reward_percentage | redeemable_percentage |
|-----------|----------|-----------|-------------------|-----------------------|
| P001      | small    | 50        | 0.1               | 0.8                   |
| P002      | medium   | 100       | 0.15              | 0.7                   |
| P003      | large    | 150       | 0.2               | 0.75                  |
| P004      | small    | 60        | 0.12              | 0.85                  |
| P005      | medium   | 120       | 0.18              | 0.65                  |

---

## Table: Analytics
| analytics_id | vendor_id | popular_product | total_transactions | total_revenue | updated_at          |
|--------------|-----------|-----------------|--------------------|---------------|---------------------|
| A001         | V001      | Product A       | 3                  | 550           | 2025-01-28 21:26:18 |
| A002         | V002      | Product B       | 2                  | 450           | 2025-01-28 21:26:18 |
| A003         | V003      | Product C       | 4                  | 600           | 2025-01-28 21:26:18 |
| A004         | V004      | Product D       | 1                  | 250           | 2025-01-28 21:26:18 |
| A005         | V005      | Product E       | 5                  | 750           | 2025-01-28 21:26:18 |

---

## Table: RewardAllocations
| allocation_id | customer_id | transaction_id | reward_points | redeemed_points | timestamp           |
|---------------|-------------|----------------|---------------|-----------------|---------------------|
| RA001         | C001        | T001           | 10            | 0               | 2025-01-28 21:26:18 |
| RA002         | C002        | T002           | 20            | 5               | 2025-01-28 21:26:18 |
| RA003         | C003        | T003           | 15            | 0               | 2025-01-28 21:26:18 |
| RA004         | C004        | T004           | 25            | 10              | 2025-01-28 21:26:18 |
| RA005         | C005        | T005           | 30            | 10              | 2025-01-28 21:26:18 |

---

## Table: Products
| product_id | product_name | customer_id | vendor_id | transaction_id | price | timestamp           | location    | frequency_of_buying |
|------------|--------------|-------------|-----------|----------------|-------|---------------------|-------------|---------------------|
| P001       | Product A    | C001        | V001      | T001           | 25    | 2025-01-28 21:26:18 | Location A  | 5                   |
| P002       | Product B    | C002        | V002      | T002           | 30    | 2025-01-28 21:26:18 | Location B  | 3                   |
| P003       | Product C    | C003        | V003      | T003           | 20    | 2025-01-28 21:26:18 | Location C  | 2                   |
| P004       | Product D    | C004        | V004      | T004           | 35    | 2025-01-28 21:26:18 | Location D  | 6                   |
| P005       | Product E    | C005        | V005      | T005           | 40    | 2025-01-28 21:26:18 | Location E  | 1                   |


### **9.1 Dashboard Display**

![image](https://github.com/user-attachments/assets/460b91d8-defd-456d-9420-5a6745fd592f)

---

## **10. Conclusion**

This script provides a basic framework for managing a customer loyalty and rewards system using SQLite and Python. It demonstrates how to create and query a database, as well as how to visualize data using `matplotlib`. The code can be extended to include more complex queries, additional visualizations, or integration with a persistent database.
